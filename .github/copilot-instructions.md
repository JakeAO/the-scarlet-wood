# Copilot / AI agent instructions for this repo

This repo is a Jekyll site (GitHub Pages) for a TTRPG campaign hub. Focus on content workflows, Jekyll collections, and GitHub Pages deploys—not app code.

## Architecture and intent
- Static site built with Jekyll using the `minima` theme; see `_config.yml`.
- Collections:
  - `info` → published at `/info/:path/`
  - `world` → published at `/world/:path/` (main player-facing lore)
  - `sessions` → published at `/sessions/:path/` (ordered by `index`)
  - `gm` → private; `output: false` and excluded from builds
- Index pages aggregate collections with Liquid:
  - `world.md` and `info.md` group items by `topic` and list each doc’s `title` and optional `summary`.
  - `sessions.md` sorts by numeric `index` (ascending) and lists `title` + optional `summary`.
- Generated output is `_site/` (do not edit by hand).

## Local dev and deploy
- Ruby/Jekyll via Bundler. Dependencies: `github-pages ~> 232`, `webrick ~> 1.9` (see `Gemfile`).
- Local serve (Windows PowerShell):
  - `bundle install ; bundle exec jekyll serve --livereload`
  - Open http://127.0.0.1:4000/ (links use `relative_url`).
- CI/CD: `.github/workflows/pages.yml` builds with Ruby 3.1 and deploys on pushes to `master`.
  - Build step: `bundle exec jekyll build --baseurl ${{ steps.pages.outputs.base_path }}`

## Content conventions (front matter)
- Required: `layout: page`, `title: ...`
- Recommended: `summary: ...`, `topic: ...`, `tags: [ ... ]`
- Sessions: add `index: <number>` to control ordering on `/sessions/`.
- Drafting: set `published: false` while drafting, then remove/flip to publish (examples in `content-templates/`).
- Examples in repo:
  - `_world/factions/deep-root-kin.md` → uses `topic: Factions`, `summary`, and tags.
  - `_world/enemies/lumberjack-billy-and-sons.md` → drafted with `published: false`.

## Files and directories that matter
- `_config.yml` → collections, permalinks, theme, plugins (`jekyll-sitemap`, `jekyll-feed`), excludes (e.g., `_gm/`, `.github/`).
- `world.md`, `info.md`, `sessions.md` → collection index pages with Liquid loops/filters (`group_by`, `sort`, `relative_url`).
- `content-templates/` → starting points for player, session, and GM articles.
- `assets/images/` → place images; in content files use Jekyll’s relative_url filter for links (see `world.md` for examples).
- `.editorconfig`, `.markdownlint.json`, `.prettierrc` → markdown formatting: LF, 2 spaces, ~100-char wrap, fenced code.

## Patterns and gotchas
- Permalinks: `_config.yml` sets `permalink: pretty`; collection permalinks use `:path`, so nested folders under `_world/` become nested URLs.
- Grouping: `world.md`/`info.md` rely on a `topic` string—omit it and the item won’t be grouped meaningfully.
- Sessions ordering: ensure `index` is an integer; missing or non-numeric values won’t sort as intended.
- Private notes: put GM notes in `_gm/` and keep `published: false`; they are also excluded in `_config.yml`.
- Don’t edit `_site/`; it’s regenerated by Jekyll and uploaded by the Pages workflow.

## Typical tasks (quick recipes)
- New world article: copy `content-templates/player-article-template.md` → place under `_world/<category>/<slug>.md` → set `title`, `summary`, `topic`, `tags` → publish by removing `published: false`.
- New session summary: copy `content-templates/session-article-template.md` → place under `_sessions/<slug>.md` → set `title`, `summary`, `index`.
- Link back to indexes: use Jekyll’s relative_url filter (see `content-templates/*` for examples of World/Info/Sessions links).